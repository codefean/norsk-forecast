{"ast":null,"code":"var _jsxFileName = \"/Users/seanfagan/Desktop/climate-globe/src/components/MapView.js\",\n  _s = $RefreshSig$();\nimport React, { useEffect, useRef, useState } from \"react\";\nimport mapboxgl from \"mapbox-gl\";\nimport Layers from \"./Layers\";\nimport SnowOverlay from \"./SnowOverlay\";\nimport { fetchStations, fetchObservations } from \"../api/frostApi\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nmapboxgl.accessToken = process.env.REACT_APP_MAPBOX_TOKEN;\nfunction MapView() {\n  _s();\n  const mapRef = useRef(null);\n  const mapObj = useRef(null);\n  const [geojson, setGeojson] = useState(null);\n  useEffect(() => {\n    async function loadFrostData() {\n      try {\n        // Fetch station list\n        const stations = await fetchStations();\n\n        // Use only the first 10 stations for testing\n        const stationIds = stations.data.slice(0, 10).map(s => s.id);\n\n        // Fetch observations as GeoJSON\n        const observationsGeoJSON = await fetchObservations(stationIds);\n\n        // Save GeoJSON into state\n        setGeojson(observationsGeoJSON);\n      } catch (error) {\n        console.error(\"Error fetching Frost data:\", error);\n      }\n    }\n    mapObj.current = new mapboxgl.Map({\n      container: mapRef.current,\n      style: \"mapbox://styles/mapbox/outdoors-v12\",\n      center: [10, 64.5],\n      zoom: 4.2,\n      pitch: 20,\n      antialias: true\n    });\n    mapObj.current.addControl(new mapboxgl.NavigationControl(), \"top-right\");\n    mapObj.current.on(\"load\", () => {\n      // Add terrain source\n      mapObj.current.addSource(\"mapbox-dem\", {\n        type: \"raster-dem\",\n        url: \"mapbox://mapbox.terrain-rgb\",\n        tileSize: 512,\n        maxzoom: 14\n      });\n      mapObj.current.setTerrain({\n        source: \"mapbox-dem\",\n        exaggeration: 1.5\n      });\n\n      // Fetch Frost observations after map loads\n      loadFrostData();\n    });\n    return () => mapObj.current.remove();\n  }, []);\n\n  // Update or add Frost data source when geojson changes\n  useEffect(() => {\n    if (geojson && mapObj.current) {\n      if (mapObj.current.getSource(\"frost-live\")) {\n        mapObj.current.getSource(\"frost-live\").setData(geojson);\n      } else {\n        mapObj.current.addSource(\"frost-live\", {\n          type: \"geojson\",\n          data: geojson\n        });\n        Layers(mapObj.current);\n      }\n    }\n  }, [geojson]);\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    style: {\n      position: \"relative\",\n      width: \"100%\",\n      height: \"100vh\"\n    },\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      ref: mapRef,\n      style: {\n        width: \"100%\",\n        height: \"100%\"\n      }\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 76,\n      columnNumber: 7\n    }, this), mapObj.current && /*#__PURE__*/_jsxDEV(SnowOverlay, {\n      geojson: geojson,\n      map: mapObj.current\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 77,\n      columnNumber: 26\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 75,\n    columnNumber: 5\n  }, this);\n}\n_s(MapView, \"YD9cl47s/zmwh5950Q5phXww6eI=\");\n_c = MapView;\nexport default MapView;\nvar _c;\n$RefreshReg$(_c, \"MapView\");","map":{"version":3,"names":["React","useEffect","useRef","useState","mapboxgl","Layers","SnowOverlay","fetchStations","fetchObservations","jsxDEV","_jsxDEV","accessToken","process","env","REACT_APP_MAPBOX_TOKEN","MapView","_s","mapRef","mapObj","geojson","setGeojson","loadFrostData","stations","stationIds","data","slice","map","s","id","observationsGeoJSON","error","console","current","Map","container","style","center","zoom","pitch","antialias","addControl","NavigationControl","on","addSource","type","url","tileSize","maxzoom","setTerrain","source","exaggeration","remove","getSource","setData","position","width","height","children","ref","fileName","_jsxFileName","lineNumber","columnNumber","_c","$RefreshReg$"],"sources":["/Users/seanfagan/Desktop/climate-globe/src/components/MapView.js"],"sourcesContent":["import React, { useEffect, useRef, useState } from \"react\";\nimport mapboxgl from \"mapbox-gl\";\nimport Layers from \"./Layers\";\nimport SnowOverlay from \"./SnowOverlay\";\nimport { fetchStations, fetchObservations } from \"../api/frostApi\";\n\nmapboxgl.accessToken = process.env.REACT_APP_MAPBOX_TOKEN;\n\nfunction MapView() {\n  const mapRef = useRef(null);\n  const mapObj = useRef(null);\n  const [geojson, setGeojson] = useState(null);\n\n  useEffect(() => {\n    async function loadFrostData() {\n      try {\n        // Fetch station list\n        const stations = await fetchStations();\n\n        // Use only the first 10 stations for testing\n        const stationIds = stations.data.slice(0, 10).map(s => s.id);\n\n        // Fetch observations as GeoJSON\n        const observationsGeoJSON = await fetchObservations(stationIds);\n\n        // Save GeoJSON into state\n        setGeojson(observationsGeoJSON);\n      } catch (error) {\n        console.error(\"Error fetching Frost data:\", error);\n      }\n    }\n\n    mapObj.current = new mapboxgl.Map({\n      container: mapRef.current,\n      style: \"mapbox://styles/mapbox/outdoors-v12\",\n      center: [10, 64.5],\n      zoom: 4.2,\n      pitch: 20,\n      antialias: true,\n    });\n\n    mapObj.current.addControl(new mapboxgl.NavigationControl(), \"top-right\");\n\n    mapObj.current.on(\"load\", () => {\n      // Add terrain source\n      mapObj.current.addSource(\"mapbox-dem\", {\n        type: \"raster-dem\",\n        url: \"mapbox://mapbox.terrain-rgb\",\n        tileSize: 512,\n        maxzoom: 14,\n      });\n\n      mapObj.current.setTerrain({ source: \"mapbox-dem\", exaggeration: 1.5 });\n\n      // Fetch Frost observations after map loads\n      loadFrostData();\n    });\n\n    return () => mapObj.current.remove();\n  }, []);\n\n  // Update or add Frost data source when geojson changes\n  useEffect(() => {\n    if (geojson && mapObj.current) {\n      if (mapObj.current.getSource(\"frost-live\")) {\n        mapObj.current.getSource(\"frost-live\").setData(geojson);\n      } else {\n        mapObj.current.addSource(\"frost-live\", { type: \"geojson\", data: geojson });\n        Layers(mapObj.current);\n      }\n    }\n  }, [geojson]);\n\n  return (\n    <div style={{ position: \"relative\", width: \"100%\", height: \"100vh\" }}>\n      <div ref={mapRef} style={{ width: \"100%\", height: \"100%\" }} />\n      {mapObj.current && <SnowOverlay geojson={geojson} map={mapObj.current} />}\n    </div>\n  );\n}\n\nexport default MapView;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}